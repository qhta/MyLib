<UserControl x:Class="Qhta.UnicodeBuild.Views.UcdCodePointsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:sf="http://schemas.syncfusion.com/wpf"
             xmlns:resources="clr-namespace:Qhta.UnicodeBuild.Resources"
             xmlns:viewModels="clr-namespace:Qhta.UnicodeBuild.ViewModels"
             xmlns:views="clr-namespace:Qhta.UnicodeBuild.Views"
             xmlns:tools="clr-namespace:Qhta.SF.WPF.Tools;assembly=Qhta.SF.WPF.Tools"
             xmlns:commands="clr-namespace:Qhta.UnicodeBuild.Commands"
             xmlns:system="clr-namespace:System;assembly=System.Runtime"
             mc:Ignorable="d" 
             d:DesignHeight="850" d:DesignWidth="1600">
  <UserControl.Resources>

    <Style TargetType="sf:AdvancedFilterControl">
      <Setter Property="CanGenerateUniqueItems" Value="False" />
    </Style>

    <Style x:Key="filterControlStyle" TargetType="sf:GridFilterControl">
      <Setter Property="FilterMode" Value="AdvancedFilter" />
    </Style>
  </UserControl.Resources>
  <UserControl.CommandBindings>
    <CommandBinding Command="Save" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Copy" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Cut" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Paste" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Delete" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Undo" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Redo" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="Find" CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="{x:Static commands:_Commander.FindNextCommand}" 
                    CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="{x:Static commands:_Commander.FillColumnCommand}"
                      CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="{x:Static commands:_Commander.ApplyBlockMappingCommand}"
                    CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="{x:Static commands:_Commander.ApplyWritingSystemRecognitionCommand}"
                    CanExecute="OnCanExecute" Executed="OnExecuted"/>
    <CommandBinding Command="{x:Static commands:_Commander.GenerateCharNamesCommand}"
                    CanExecute="OnCanExecute" Executed="OnExecuted"/>
  </UserControl.CommandBindings>

  <Grid>
    <Grid.RowDefinitions>
      <RowDefinition Height="Auto"/>
      <RowDefinition Height="*"/>
      <RowDefinition Height="Auto"/>
    </Grid.RowDefinitions>
    <!-- Menu Bar -->
    <Menu Grid.Row="0">
      <MenuItem Header="{x:Static resources:Strings.Data}">
        <MenuItem Header="{x:Static resources:Strings.Save}" Command="Save"/>
      </MenuItem>
      <MenuItem Header="{x:Static resources:Strings.Edit}">
        <MenuItem Header="Undo" Command="Undo"/>
        <MenuItem Header="Redo" Command="Redo"/>
        <Separator/>
        <MenuItem Header="{x:Static resources:Strings.Cut}" Command="Cut"/>
        <MenuItem Header="{x:Static resources:Strings.Copy}" Command="Copy"/>
        <MenuItem Header="{x:Static resources:Strings.Paste}" Command="Paste"/>
        <Separator/>
        <MenuItem Header="{x:Static resources:Strings.Find}" 
                  Command="Find"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
      </MenuItem>
      <MenuItem Header="{x:Static resources:Strings.Tools}">
        <MenuItem Header="{x:Static resources:Strings.FillColumn}"
                  ToolTip ="{x:Static resources:Strings.FillColumnTooltip}"
                  Command="{x:Static commands:_Commander.FillColumnCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
        <Separator/>
        <MenuItem Header="{x:Static resources:Strings.ApplyBlockMapping}"
                  ToolTip="{x:Static resources:Strings.ApplyBlockMappingTooltip}"
                  Command="{x:Static commands:_Commander.ApplyBlockMappingCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
        <MenuItem Header="{x:Static resources:Strings.ApplyWritingSystemsMappingFromFile}"
                  ToolTip="{x:Static resources:Strings.ApplyWritingSystemsMappingFromFileTooltip}"
                  Command="{x:Static commands:_Commander.ApplyWritingSystemMappingCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
        <MenuItem Header="{x:Static resources:Strings.ApplyWritingSystemsRecognition}"
                  ToolTip="{x:Static resources:Strings.ApplyWritingSystemsRecognitionTooltip}"
                  Command="{x:Static commands:_Commander.ApplyWritingSystemRecognitionCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
        <Separator/>
        <MenuItem Header="{x:Static resources:Strings.GenerateNamesWithoutWS}"
                  ToolTip="{x:Static resources:Strings.GenerateNamesWithoutWSTooltip}"
                  Command="{x:Static commands:_Commander.GenerateNamesWithoutWSCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>
        <MenuItem Header="{x:Static resources:Strings.GenerateCharNames}"
                  ToolTip="{x:Static resources:Strings.GenerateCharNamesTooltip}"
                  Command="{x:Static commands:_Commander.GenerateCharNamesCommand}"
                  CommandParameter="{Binding ElementName=CodePointDataGrid}"/>


      </MenuItem>
      <MenuItem Header="{x:Static resources:Strings.Help}">
        <MenuItem Header="{x:Static resources:Strings.About}" Command="Help"/>
      </MenuItem>
    </Menu>



    <sf:SfDataGrid x:Name="CodePointDataGrid" 
                     Grid.Row="1"
                     DataContext ="{StaticResource ViewModels}"
                     ItemsSource ="{Binding Instance.UcdCodePoints}"
                     AutoGenerateColumns="False"
                     tools:SfDataGridBehavior.AllowRowResizing="True"
                   >
      <sf:SfDataGrid.Columns>
        <sf:GridTemplateColumn 
          MappingName="CP"
          HeaderText="{x:Static resources:UcdCodePointStrings.CP}" 
          VerticalAlignment="Top"
          GridValidationMode="InEdit"
          ColumnFilter="DisplayText"
          CellTemplate="{StaticResource CodePointTemplate}"
          AllowEditing="False"
          >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.CP}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.CPTooltip}" />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
        </sf:GridTemplateColumn>
        <sf:GridTextColumn 
          MappingName="CharName" 
          HeaderText="{x:Static resources:UcdCodePointStrings.Name}"
          VerticalAlignment="Top"
          Width="100"
          >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.Name}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.NameTooltip}"  />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
        </sf:GridTextColumn>

        <sf:GridTemplateColumn 
          MappingName="Glyph" 
          HeaderText="{x:Static resources:UcdCodePointStrings.Glyph}"
          VerticalAlignment="Top"
          Width="34"
          AllowFiltering="False"
          AllowSorting="False"
          AllowEditing="False"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.Glyph}"
                         ToolTip="{x:Static resources:UcdCodePointStrings.GlyphTooltip}" />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <Grid>
                <Grid.ColumnDefinitions>
                  <ColumnDefinition Width="*"/>
                  <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding Glyph}" 
                           Padding="3"
                           FontSize="{Binding GlyphSize}"/>
                <sf:UpDown Grid.Column="1" 
                            Value="{Binding GlyphSize}"
                            MinValue="12"
                            MaxValue="36"
                            Width="16"
                            ValueChanged="UpDown_OnValueChanged"
                            />
              </Grid>
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridTemplateColumn>

        <sf:GridTextColumn 
          MappingName="Description" 
          HeaderText="{x:Static resources:UcdCodePointStrings.Description}" 
          VerticalAlignment="Top"
          AllowEditing="False"
          Width="200"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.Description}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.DescriptionTooltip}"  />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
        </sf:GridTextColumn>

        <sf:GridComboBoxColumn x:Name="CtgColumn"
           MappingName="Category" 
           HeaderText="{x:Static resources:UcdCodePointStrings.Category}"
           ItemsSource="{Binding Source={StaticResource ViewModels}, 
             Path=Instance.UnicodeCategoriesList}"
           DisplayMemberPath="Name"
           VerticalAlignment="Top"
           AllowEditing="False"
           Width="150"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.Category}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.CtgTooltip}"  
                         />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{Binding Category.Name}" 
                         ToolTip="{Binding Category.Description}" 
                         Padding="3"
                         />
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridComboBoxColumn>

        <sf:GridComboBoxColumn x:Name="UcdBlockColumn"
          MappingName="Block" 
          HeaderText="{x:Static resources:UcdCodePointStrings.UcdBlock}"
          ItemsSource="{Binding Source={StaticResource ViewModels}, 
            Path=Instance.SelectableBlocks}"
          DisplayMemberPath="DisplayName" 
          VerticalAlignment="Top"
          AllowEditing="True"
          Width="150"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.UcdBlock}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.UcdBlockTooltip}" 
                         />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{Binding Block.Name, FallbackValue=''}" 
                         ToolTip="{Binding Block.Description, FallbackValue=''}" 
                         Padding="3"
                         />
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridComboBoxColumn>

        <sf:GridComboBoxColumn 
          MappingName="WritingSystem" 
          HeaderText="{x:Static resources:UcdCodePointStrings.WritingSystem}"
          ItemsSource="{Binding Source={StaticResource ViewModels}, 
            Path=Instance.SelectableScripts}"
          DisplayMemberPath="DisplayName"
          SortMode="Display"
          VerticalAlignment="Top"
          AllowEditing="True"
          Width="100"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.WritingSystem}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.WritingSystemTooltip}"
                         />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{Binding WritingSystem.Name, FallbackValue=''}" 
                         ToolTip="{Binding WritingSystem.Description, FallbackValue=''}"
                         Padding="3"
                         />
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridComboBoxColumn>


        <sf:GridComboBoxColumn 
          MappingName="SymbolSet" 
          HeaderText="{x:Static resources:UcdCodePointStrings.SymbolSet}"
          ItemsSource="{Binding Source={StaticResource ViewModels}, 
            Path=Instance.SelectableSymbolSets}"
          DisplayMemberPath="DisplayName" 
          VerticalAlignment="Top"
          AllowEditing="True"
          Width="100"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.SymbolSet}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.SymbolSetTooltip}"
                         />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{Binding SymbolSet.Name, FallbackValue=''}" 
                         ToolTip="{Binding SymbolSet.Description, FallbackValue=''}" 
                         Padding="3"
                         />
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridComboBoxColumn>

        <sf:GridComboBoxColumn 
          MappingName="Subset" 
          HeaderText="{x:Static resources:UcdCodePointStrings.Subset}"
          ItemsSource="{Binding Source={StaticResource ViewModels}, 
            Path=Instance.SelectableSubsets}"
          DisplayMemberPath="DisplayName" 
          VerticalAlignment="Top"
          AllowEditing="True"
          Width="100"
        >
          <sf:GridColumn.HeaderTemplate>
            <DataTemplate>
              <TextBlock Text="{x:Static resources:UcdCodePointStrings.Subset}" 
                         ToolTip="{x:Static resources:UcdCodePointStrings.SubsetTooltip}"
                         />
            </DataTemplate>
          </sf:GridColumn.HeaderTemplate>
          <sf:GridColumn.CellTemplate>
            <DataTemplate DataType="{x:Type viewModels:UcdCodePointViewModel}">
              <TextBlock Text="{Binding Subset.Name, FallbackValue=''}" 
                         ToolTip="{Binding Subset.Description, FallbackValue=''}" 
                         Padding="3"
              />
            </DataTemplate>
          </sf:GridColumn.CellTemplate>
        </sf:GridComboBoxColumn>

      </sf:SfDataGrid.Columns>
    </sf:SfDataGrid>

    <tools:RecordNavigationBar Grid.Row="2" DataGrid="{Binding ElementName=CodePointDataGrid}"/>
    <Grid x:Name="StatusBar"  Grid.Row="2" Height="Auto" Background="LightGray" 
          Visibility="{Binding Source={StaticResource ViewModels}, 
                    Path=Instance.UcdCodePoints.IsBusy, 
                   Converter={StaticResource BoolToVisibilityConverter}}">

      <Grid.ColumnDefinitions>
        <ColumnDefinition Width="Auto" />
        <ColumnDefinition Width="*" />
        <ColumnDefinition Width="Auto" />
      </Grid.ColumnDefinitions>
      <TextBlock Grid.Column="0" Text="{Binding Source={StaticResource ViewModels}, Path=Instance.UcdCodePoints.StatusMessage}" VerticalAlignment="Center" Margin="5,0" />
      <ProgressBar Grid.Column="1" Minimum="0" Maximum="100" Value="{Binding Source={StaticResource ViewModels}, Path=Instance.UcdCodePoints.ProgressValue}" Height="20" />
      <Button Grid.Column="2" 
              Content="{x:Static resources:Strings.Cancel}" Height="26" Margin="5,0" 
              Command="{Binding Source={StaticResource ViewModels}, Path=Instance.UcdCodePoints.BreakCommand}" />
    </Grid>
  </Grid>
</UserControl>
