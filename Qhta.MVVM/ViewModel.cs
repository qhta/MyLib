namespace Qhta.MVVM
{
  /// <summary>
  /// Base class of view model.
  /// </summary>
  public class ViewModel : ObservableObject, INotifyPropertyChanged, IViewModel, IValidated
  {
    /// <summary>
    /// A method to notify that a property has changed.
    /// </summary>
    /// <param name="propertyName"></param>
    public new void NotifyPropertyChanged(string propertyName)
    {
      base.NotifyPropertyChanged(propertyName);
    }

    /// <summary>
    /// A method to notify that a property has changed.
    /// </summary>
    /// <param name="propertyName"></param>
    /// <param name="oldValue">Old value of the property</param>
    /// <param name="newValue">New value of the property</param>
    public new void NotifyPropertyChanged(string propertyName, object? oldValue, object? newValue)
    {
      base.NotifyPropertyChanged(propertyName, oldValue, newValue);
    }

    /// <summary>
    /// Specifies if the data of view model is valid.
    /// </summary>
    [DataGridColumn(IsAutoGenerated = false)]
    public virtual bool? IsValid 
    { 
      get => _IsValid;
      set
      {
        if (value != _IsValid)
        {
          _IsValid = value;
          NotifyPropertyChanged(nameof(IsValid));
        }
      }
    }

    private bool? _IsValid;
  }
}
